const _0x23d01a=_0x5235;!function(){for(var n=_0x5235,e=_0x5c0d();;)try{if(261884==-parseInt(n(513))*(-parseInt(n(622))/2)+-parseInt(n(557))/3+-parseInt(n(587))/4+-parseInt(n(580))/5+-parseInt(n(601))/6+parseInt(n(578))/7*(-parseInt(n(485))/8)+parseInt(n(671))/9)break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x30445c from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x5235,t={XZCKO:function(n,e){return n*e},nZMER:function(n,e){return n/e}};return t[e(527)](n,t[e(537)](Math.PI,180))},radToDeg=n=>{var e=_0x5235,t={IQcSz:function(n,e){return n*e},vBioY:function(n,e){return n/e}};return t[e(665)](n,t[e(629)](180,Math.PI))},mouseDownHandler=async n=>{var e=_0x5235,t={OYGoS:function(n,e){return n&&e},PbViz:function(n,e){return n!==e},KawIL:e(651),euhtP:function(n,e,t){return n(e,t)},rDBTE:e(632)+e(479),hRRZc:function(n,e){return n!==e},hXhVw:function(n,e){return n!=e},AFPIT:function(n,e){return n==e},ZDQlZ:function(n){return n()},FpjUE:function(n,e){return n==e},zVGZX:function(n,e){return n<e},RBGoS:function(n){return n()},qcFSt:function(n,e){return n(e)},bAkjB:e(567),lKPjG:function(n){return n()}};if(!(isTransforming=!t[e(652)](isTransforming,!editingId)&&isTransforming)&&!t[e(511)](n[e(626)][e(501)],t[e(510)])){var n=tracking.x,a=tracking.y,r=await t[e(593)](Post,t[e(475)],{x:n,y:a});if(r[e(487)]&&t[e(495)](editingId,r[e(589)]))if(t[e(648)](decorateMenu,null)&&t[e(543)](decorateMenu[e(519)],2)){var o=await t[e(536)](getOwnedObjects);if(!t[e(521)](o[decorateMenu[e(597)][e(554)+"u"][e(488)]][e(654)],r[e(589)])){for(var i=null,c=0;t[e(499)](c,o[e(594)]);c++)if(t[e(521)](o[c][e(654)],r[e(589)])){i=c;break}t[e(648)](i,null)&&(decorateMenu[e(597)][e(554)+"u"][e(488)]=i),decorateMenu[e(597)][e(554)+"u"][e(519)]()}}else t[e(514)](clearData),editingId=r[e(589)],t[e(604)](changeEntity,editingId),isTransforming=!1;else if(!r[e(487)]){var s=t[e(596)][e(553)]("|");let n=0;for(;;){switch(s[n++]){case"0":transformControls[e(524)]=!1;continue;case"1":isTransforming=!1;continue;case"2":if(t[e(648)](decorateMenu,null)&&t[e(543)](decorateMenu[e(519)],2))return;continue;case"3":editingId=null;continue;case"4":t[e(678)](clearData);continue}break}}}},handleTracking=(window[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(506),mouseDownHandler),n=>{var e=_0x23d01a,t={uhceU:function(n,e){return n-e},KbpPP:function(n,e){return n-e},EAwzC:function(n,e,t){return n(e,t)},ZXOLi:function(n,e,t){return n(e,t)}},a=t[e(491)](n[e(635)],n[e(626)][e(609)]),n=t[e(478)](n[e(592)],n[e(626)][e(609)]);tracking.x=t[e(642)](normalize,a,document[e(605)+e(600)][e(569)+"h"]),tracking.y=t[e(507)](normalize,n,document[e(605)+e(600)][e(615)+"ht"])}),Scene=new _0x30445c[_0x23d01a(509)],Renderer=new _0x30445c[_0x23d01a(668)+_0x23d01a(614)]({alpha:!0}),Camera=(Renderer[_0x23d01a(611)](window[_0x23d01a(548)],window[_0x23d01a(582)+"t"]),document[_0x23d01a(675)+_0x23d01a(539)](_0x23d01a(512))[_0x23d01a(591)+"d"](Renderer[_0x23d01a(602)]),new _0x30445c[_0x23d01a(659)+_0x23d01a(583)](50,window[_0x23d01a(548)]/window[_0x23d01a(582)+"t"],.1,1e4)),boxGeometry=(Camera[_0x23d01a(655)][_0x23d01a(586)]=_0x23d01a(563),new _0x30445c[_0x23d01a(562)+"y"](1,1,1)),meshPhongMaterial=new _0x30445c[_0x23d01a(603)+_0x23d01a(542)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x30445c[_0x23d01a(494)](boxGeometry,meshPhongMaterial);Mesh[_0x23d01a(655)][_0x23d01a(586)]=_0x23d01a(563),Mesh[_0x23d01a(534)][_0x23d01a(547)](1,1,1),Scene[_0x23d01a(492)](Mesh),Renderer[_0x23d01a(602)][_0x23d01a(550)][_0x23d01a(490)]=_0x23d01a(613);let animationFrameActive=null;function _0x5235(n,e){const t=_0x5c0d();return(_0x5235=function(n,e){return n-=475,t[n]})(n,e)}function renderGeometry(){var n=_0x23d01a;animationFrameActive={VJajz:function(n,e){return n(e)}}[n(515)](requestAnimationFrame,renderGeometry),Renderer[n(640)](Scene,Camera)}function _0x5c0d(){const n=["EAwzC","Wqvbf","lper #enti","BAThf","reRmu","xWYdz","hXhVw","fov","ttWpW","CANVAS","OYGoS","SANWq","object","rotation","rbVOa","gzsWx","kFBcj","Perspectiv","ect","mouseUp","l-name","toggleMous","2|4","IQcSz","KBpWF","ty-pitch","WebGLRende","change","xGgqk","11193408CozxOl","roll","14|8|0|12|","PKoIs","querySelec","wdKFM","CchXV","lKPjG","rDBTE","pSyzw","keydown","KbpPP","ity","vGIKW","eWsWa","nSnap","prevY","val","1074784QQlAVS","whiOR","hit","stash","lper #mode","display","uhceU","add","ty-yaw","Mesh","hRRZc","position","jWPXT","translate","zVGZX","gSMqi","tagName","load_entit","HLfTk","mouseDown","y_info","mousedown","ZXOLi","xcnTW","Scene","KawIL","PbViz","#decorate","188293qMaYtN","RBGoS","VJajz","5|1|4|3|0|","hash","iyJWg","sort","pitch","FpjUE","attach","WRjpA","visible","UFWGg","OoCSC","XZCKO","3|4|2|6","aPSOm","0|5|3|6|1|","QPNUN","prevYaw","setTransla","scale","#object-he","ZDQlZ","nZMER","lmVll","tor","WANkl","wIRXf","aterial","AFPIT","ty-y","UrYSc","rENbn","set","innerWidth","key","style","mousemove","addEventLi","split","sortingMen","block","prevX","525342NiLYJy","setRotatio","eMovement","GpZBe","rotate","BoxGeometr","YZX","edit_entit","jFeXm","1|10|15|9|","2|4|3|0|1","wICuo","scrollWidt","prevRoll","UbxZJ","alpha","XmSbD","prevPitch","xYWsR","CEqBo","setMode","14YlKIsn","ground_obj","353965bzaSbf","push","innerHeigh","eCamera","RWPaz","shvKr","order","1347740uYVwQF","stener","entity","naNZN","appendChil","pageY","euhtP","length","LBYoH","bAkjB","categories","cam","tionSnap","ement","3041256mkJXqt","domElement","MeshPhongM","qcFSt","documentEl","ectionMatr","ty-z","krOue","offsetTop","RXSyR","setSize","ty-x","none","rer","scrollHeig","YDCTn","bQRCR","WkxKj","Gimgt","prevZ","updateProj","4OvJXlf","toggleCurs","yaw","exists","target","tYRdQ","wcZBU","vBioY","sNTab","distance","select_ent","0|1|3|4|2|","5|11|13|7|","pageX","nKLCD","NqgDy","ty-roll","aymXa","render","XIcpA"];return(_0x5c0d=function(){return n})()}function showGeometry(){var n=_0x23d01a,e={RWPaz:n(555)};transformControls[n(524)]=!1,Renderer[n(602)][n(550)][n(490)]=e[n(584)]}function hideGeometry(){var n=_0x23d01a,e={UbxZJ:n(613)};transformControls[n(524)]=!1,Renderer[n(602)][n(550)][n(490)]=e[n(571)]}function hideTransformControls(){var n=_0x23d01a;transformControls[n(524)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x23d01a(602)]),editEntity=(transformControls[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(669),()=>{var n=_0x23d01a,e={CchXV:function(n,e){return n(e)},GpZBe:function(n){return n()}},t=objectInfos[editingId];Mesh[n(496)].x&&Mesh[n(496)].y&&Mesh[n(496)].z&&t&&(t.x=Mesh[n(496)].x,t.y=-Mesh[n(496)].z,t.z=Mesh[n(496)].y,t[n(520)]=e[n(677)](radToDeg,Mesh[n(655)].x),t[n(672)]=e[n(677)](radToDeg,-Mesh[n(655)].z),t[n(624)]=e[n(677)](radToDeg,Mesh[n(655)].y),e[n(560)](editEntity),Renderer[n(640)](Scene,Camera))}),()=>{var n=_0x23d01a,e={gSMqi:function(n,e,t){return n(e,t)},SANWq:n(564)+"y",sNTab:function(n,e){return n(e)},PKoIs:function(n,e){return n(e)},CEqBo:function(n,e){return n(e)},aymXa:function(n,e){return n(e)},rbVOa:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(500)](Post,e[n(653)],{id:editingId,alpha:e[n(630)](parseInt,t[n(572)]),x:e[n(674)](parseFloat,t.x),y:e[n(576)](parseFloat,t.y),z:e[n(639)](parseFloat,t.z),pitch:e[n(674)](parseFloat,t[n(520)]),roll:e[n(656)](parseFloat,t[n(672)]),yaw:e[n(656)](parseFloat,t[n(624)])}),e[n(674)](setObjectHelperValues,t)}),storeData=(transformControls[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(504),()=>{var n=_0x23d01a;isTransforming=!0,{nKLCD:function(n){return n()}}[n(636)](storeData)}),transformControls[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(661),()=>{var n=_0x23d01a,e=objectInfos[editingId];e&&(e.x=Mesh[n(496)].x,e.y=-Mesh[n(496)].z,e.z=Mesh[n(496)].y,isTransforming=!1)}),transformControls[_0x23d01a(533)+_0x23d01a(599)](.1),transformControls[_0x23d01a(611)](.8),transformControls[_0x23d01a(558)+_0x23d01a(482)](degToRad(15)),transformControls[_0x23d01a(522)](Mesh),Scene[_0x23d01a(492)](transformControls),()=>{var e=_0x23d01a,t={QPNUN:function(n,e){return n!==e},LBYoH:function(n,e){return n!==e},xGgqk:e(633)+"5"},a=objectInfos[editingId];if(a&&t[e(531)](a.x,0)&&t[e(531)](a.y,0)&&t[e(595)](a.z,0)){var r=t[e(670)][e(553)]("|");let n=0;for(;;){switch(r[n++]){case"0":furniData[e(556)][e(581)](a.x);continue;case"1":furniData[e(483)][e(581)](a.y);continue;case"2":furniData[e(570)][e(581)](a[e(672)]);continue;case"3":furniData[e(620)][e(581)](a.z);continue;case"4":furniData[e(574)][e(581)](a[e(520)]);continue;case"5":furniData[e(532)][e(581)](a[e(624)]);continue}break}}});function cancelRenderGeometry(){var n=_0x23d01a;animationFrameActive&&({xcnTW:function(n,e){return n(e)}}[n(508)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(n){var e=_0x23d01a,t={xWYdz:function(n,e){return n===e},WRjpA:e(561),vGIKW:e(498)};t[e(647)](n,t[e(523)])?transformControls[e(577)](t[e(523)]):transformControls[e(577)](t[e(480)])}function setRotationSnap(n){var e=_0x23d01a;transformControls[e(558)+e(482)](n)}function setTranslationSnap(n){var e=_0x23d01a;transformControls[e(533)+e(599)](n)}const normalize=(n,e)=>{var t=_0x23d01a,a={gzsWx:function(n,e){return n+e},RXSyR:function(n,e){return n/e},YDCTn:function(n,e){return n*e},XmSbD:function(n,e){return n-e}};return a[t(657)](a[t(610)](a[t(616)](1,a[t(573)](n,0)),a[t(573)](e,0)),0)},handleUpdatePositions=(window[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(551),handleTracking),n=>{var e=_0x23d01a,t={wdKFM:function(n,e){return n(e)},Gimgt:function(n,e){return n(e)},aPSOm:function(n,e,t){return n(e,t)},wIRXf:function(n,e){return n(e)}},a=(Camera[e(496)][e(547)](n[e(598)][e(496)].x,n[e(598)][e(496)].z,-n[e(598)][e(496)].y),n[e(598)][e(655)].x),r=n[e(598)][e(655)].z,o=n[e(598)][e(655)].y;Camera[e(655)][e(547)](t[e(676)](degToRad,a),t[e(619)](degToRad,t[e(529)](zRotationHandler,a,r)),t[e(541)](degToRad,o)),Camera[e(649)]=n[e(598)][e(649)],Camera[e(621)+e(606)+"ix"](),n[e(589)][e(496)]&&(Mesh[e(496)][e(547)](n[e(589)][e(496)].x,n[e(589)][e(496)].z,-n[e(589)][e(496)].y),Mesh[e(655)][e(547)](t[e(676)](degToRad,n[e(589)][e(655)].x),t[e(619)](degToRad,n[e(589)][e(655)].z),t[e(619)](degToRad,-n[e(589)][e(655)].y)))}),changeEntity=async n=>{var e=_0x23d01a,t={jFeXm:function(n,e,t){return n(e,t)},rENbn:e(502)+e(505),UrYSc:function(n,e){return n(e)},tYRdQ:function(n,e){return n(e)}},n=await t[e(565)](Post,t[e(546)],{id:t[e(545)](parseInt,n)});t[e(627)](setEntityData,n)},zRotationHandler=(n,e)=>{var t=_0x23d01a,a={bQRCR:function(n,e){return e<n},WANkl:function(n,e){return n<e},XIcpA:function(n,e){return n<e},KBpWF:function(n,e){return e<n}};return(!a[t(617)](n,0)||!a[t(540)](n,90))&&(a[t(617)](n,-180)&&a[t(641)](n,-90)||a[t(666)](n,0))?-e:e},setEntityData=n=>{var e=_0x23d01a,t={jWPXT:e(673)+e(634)+e(566)+e(528),xYWsR:function(n,e){return n(e)},whiOR:function(n,e){return n!==e},iyJWg:function(n){return n()}},a=t[e(497)][e(553)]("|");let r=0;for(;;){switch(a[r++]){case"0":editable=!0;continue;case"1":editingData.y=n.y;continue;case"2":transformControls[e(524)]=!0;continue;case"3":editingData[e(624)]=n[e(624)];continue;case"4":editingData[e(631)]=n[e(631)];continue;case"5":objectInfos[editingId]={id:n.id,hash:n[e(517)],alpha:n[e(572)],x:n.x,y:n.y,z:n.z,pitch:n[e(520)],roll:n[e(672)],yaw:n[e(624)],distance:n[e(631)],quaternion:{}};continue;case"6":t[e(575)](setObjectHelperValues,n);continue;case"7":editingData.x=n.x;continue;case"8":t[e(486)](editingId,n.id)&&t[e(518)](clearData);continue;case"9":editingData[e(672)]=n[e(672)];continue;case"10":editingData.z=n.z;continue;case"11":editingData[e(517)]=n[e(517)];continue;case"12":editingId=n.id;continue;case"13":editingData[e(572)]=n[e(572)];continue;case"14":if(n[e(625)])continue;return editable=!1,void(transformControls[e(524)]=!1);case"15":editingData[e(520)]=n[e(520)];continue}break}},setObjectHelperValues=n=>{var e=_0x23d01a,t={WkxKj:e(530)+e(664),ttWpW:function(n,e){return n(e)},shvKr:e(535)+e(489)+e(662),wICuo:e(535)+e(644)+e(667),BAThf:e(535)+e(644)+e(638),eWsWa:e(535)+e(644)+e(544),OoCSC:e(535)+e(644)+e(493),NqgDy:e(535)+e(644)+e(612),HLfTk:e(535)+e(644)+e(607)},a=t[e(618)][e(553)]("|");let r=0;for(;;){switch(a[r++]){case"0":t[e(650)]($,t[e(585)])[e(484)](n[e(517)]);continue;case"1":t[e(650)]($,t[e(568)])[e(484)](n[e(520)]);continue;case"2":t[e(650)]($,t[e(645)])[e(484)](n[e(672)]);continue;case"3":t[e(650)]($,t[e(481)])[e(484)](n.y);continue;case"4":t[e(650)]($,t[e(526)])[e(484)](n[e(624)]);continue;case"5":t[e(650)]($,t[e(637)])[e(484)](n.x);continue;case"6":t[e(650)]($,t[e(503)])[e(484)](n.z);continue}break}},clearData=()=>{var n=_0x23d01a,e={Wqvbf:n(516)+"2"}[n(643)][n(553)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(570)]=[];continue;case"1":furniData[n(556)]=[];continue;case"2":furniData[n(532)]=[];continue;case"3":furniData[n(574)]=[];continue;case"4":furniData[n(620)]=[];continue;case"5":furniData[n(483)]=[];continue}break}};window[_0x23d01a(552)+_0x23d01a(588)](_0x23d01a(477),async n=>{var e=_0x23d01a,t={pSyzw:function(n,e){return n===e},wcZBU:function(n,e){return n(e)},krOue:e(663)+e(559),reRmu:function(n,e){return n(e)},naNZN:e(623)+"or",lmVll:function(n,e){return n===e},UFWGg:function(n,e,t){return n(e,t)},kFBcj:e(579)+e(660)};t[e(476)](n[e(549)],"F6")&&t[e(628)](Post,t[e(608)]),t[e(476)](n[e(549)],"F5")&&t[e(646)](Post,t[e(590)]),(t[e(476)](n[e(549)],"G")||t[e(538)](n[e(549)],"g"))&&(n=await t[e(525)](Post,t[e(658)],{id:t[e(646)](parseInt,editingId)}),t[e(628)](setEntityData,n))});export{setDecorateMenu,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};